<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>예약 출고 관리표 📦 v5.6</title>
  <link rel="stylesheet" href="css/reservation.css" />
</head>
<body>
<div class="app">
  <div class="app-header">
    <h1>예약 출고 관리표 📱</h1>
    <button class="btn btn-red btn-clear-top" onclick="clearBeforeDate()">🗑 선택일 이전 예약 초기화</button>
  </div>

  <button class="btn btn-main" onclick="openModal()">+ 예약 등록</button>

  <div class="section">
    <div class="section-title">출고일별 조회</div>
    <div class="row">
      <label>출고일</label>
      <input type="date" id="viewDate" />
      <button class="btn btn-blue" onclick="openQuickRange('normal')">일반 조회</button>
      <button class="btn btn-green" onclick="openQuickRange('item')">품목 조회</button>
    </div>
    <!-- 🔹 빠른 기간 선택 박스 (출고일 입력 아래 작게 표시) -->
    <div class="quick-range-inline" id="quickRangeBg">
	      <div class="quick-range">
	        <div class="quick-range-title">기간</div>
          <div class="quick-range-grid">
            <button onclick="selectQuickRange('yesterday')">어제</button>
            <button onclick="selectQuickRange('today')">오늘</button>
            <button onclick="selectQuickRange('tomorrow')">내일</button>
            <button onclick="selectQuickRange('all')">모두</button>
          </div>
          <div class="quick-range-manual">
            <span>직접</span>
            <label class="date-label">
              <input type="date" id="rangeStart" />
              <span class="date-label-text">시작일</span>
            </label>
            <span>~</span>
            <label class="date-label">
              <input type="date" id="rangeEnd" />
              <span class="date-label-text">종료일</span>
            </label>
            <button class="btn btn-blue" onclick="applyManualRange()">조회</button>
          </div>
	      </div>
    </div>
  </div>

  <div class="section">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
      <div class="section-title">조회 결과</div>
      <div style="display:flex; gap:6px;">
        <button class="btn btn-blue" onclick="handleActionChoice('edit')">선택 거래처 수정</button>
        <button class="btn btn-red" onclick="handleActionChoice('delete')">선택 거래처 삭제</button>
      </div>
    </div>
    <div id="reservationList"></div>
  </div>
</div>

<!-- 🔹 (이전) 선택한 거래처 수정/삭제 팝업은 상단 두 개 버튼으로 대체됨 -->

<!-- 🔹 예약 등록 모달 -->
<div class="modal-bg" id="modalBg">
  <div class="modal">
    <div class="modal-top-row">
      <h2>예약 등록</h2>
      <div class="modal-date-inline">
        <label>출고일</label>
        <input type="date" id="date" />
      </div>
    </div>

    <div class="row"><label>거래처</label><input id="name" placeholder="예: 강서식당" /></div>
    <div class="row">
      <label>연락처</label>
      <input id="phone" placeholder="예: 010-1234-5678" oninput="formatPhoneNumber(this)" maxlength="13" />
    </div>

    <div class="row">
      <label>배송방식</label>
      <select id="deliveryType" onchange="toggleAddress()">
        <option value="배달">배달</option>
        <option value="픽업">픽업</option>
      </select>
    </div>
    <div class="row" id="addressRow">
      <label>주소</label>
      <input id="address" placeholder="예: 서울 강서구 ..." />
    </div>

    <div class="row"><label>메모</label><input id="memo" placeholder="예: 3시 이전 배송" /></div>

    <div class="modal-section-title" style="margin-top:10px;font-weight:700;">상품 목록</div>
    <div class="sample-box" id="sampleBox"></div>

    <table>
      <thead><tr><th>품목명(수량)</th></tr></thead>
      <tbody id="itemBody"></tbody>
    </table>

    <div style="display:flex;gap:8px;margin-top:10px;">
      <button class="btn btn-green" style="flex:1" onclick="saveReservation()">저장</button>
      <button class="btn btn-red" style="flex:1" onclick="closeModal()">닫기</button>
    </div>
  </div>
</div>

<script src="js/reservation.js"></script>
<link rel="manifest" href="manifest.json">
<!-- 서비스워커는 개발 중 캐시 때문에 혼란을 줄 수 있어 잠시 비활성화 -->
<!--
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log("✅ Service Worker Registered"))
      .catch(err => console.log("SW 등록 실패:", err));
  }
</script>
-->
</body>
</html>
